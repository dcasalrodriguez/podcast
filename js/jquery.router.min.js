!function(a){function j(){if(f=!0,d.fromHash=!1,b){if(0===location.hash.indexOf("#!/")){var e=location.pathname+location.hash.replace(/^#!\//gi,"");history.replaceState({},"",e),d.fromHash=!0}a(window).bind("popstate",n)}else c?a(window).bind("hashchange.router",n):setInterval(function(){location.href!=g&&(n(),g=location.href)},500)}function k(a){var c=a?a:location.pathname;if(c=decodeURI(c),!b){if(0!==location.hash.indexOf("#!/"))return"";c+=location.hash.substring(3)}return c=c.replace(/\/$/,"")}function l(a){for(var b=[],c=0,f=e.length;c<f;c++){var g=e[c];if("regexp"==g.type){var h=a.match(g.route);if(h){var i={};i.matches=h,b.push({route:g,data:i}),d.currentId=g.id;break}}else{var j=a.split("/"),k=g.route.split("/");if(k.length==j.length){for(var i={},m=0,n=0,o=k.length;n<o;n++){var p=0===k[n].indexOf(":");p?(i[k[n].substring(1)]=decodeURI(j[n]),m++):k[n]==j[n]&&m++}if(k.length==m){b.push({route:g,data:i}),d.currentId=g.id,d.currentParameters=i;break}}}}return b}function m(){var a=k(location.pathname),b=l(a);if(0==b.length)return d.errorCallback(a);for(var c=0,e=b.length;c<e;c++)b[c].route.callback(b[c].data)}function n(a){null!=a&&a.originalEvent&&void 0!==a.originalEvent.state?m():c?m():c||b||m()}var b=history&&history.pushState,c=!b&&"onhashchange"in window&&!1,d={},e=[],f=!1,g=location.href,i=function(){};d.currentId="",d.currentParameters={},d.errorCallback=i,d.capabilities={hash:c,pushState:b,timer:!c&&!b},d.reset=function(){var a={};a.currentId="",a.currentParameters={}},d.add=function(a,b,c){"function"==typeof b&&(c=b,delete b);var d="object"==typeof a;d||(a.lastIndexOf("/")==a.length-1&&(a=a.substring(0,a.length-1)),a=a.replace(location.protocol+"//","").replace(location.hostname,""));var g={route:a,callback:c,type:d?"regexp":"string",id:b};e.push(g),f||j()},d.addErrorHandler=function(a){this.errorCallback=a},j(),d.go=function(a,c){if(b)history.pushState({},c,a),m();else{a=a.replace(location.protocol+"//","").replace(location.hostname,"");var d=a.replace(location.pathname,"");d.indexOf("!")<0&&(d="!/"+d),location.hash=d}},d.check=d.redo=function(){m(!0)},d.parameters=function(a){var b=k(a),c=l(b);return 0==c.length?d.currentParameters={}:d.currentParameters=c[0].data,d.currentParameters},a.router?window.console&&window.console.warn&&console.warn("jQuery.status already defined. Something is using the same name."):a.router=d}(jQuery);